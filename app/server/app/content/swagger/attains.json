{
  "openapi": "3.0.0",
  "servers": [
    {
      "description": "Production",
      "url": "https://owapps.app.cloud.gov/expertquery/attains"
    },
    {
      "description": "Staging",
      "url": "https://owapps-stage.app.cloud.gov/expertquery/attains"
    },
    {
      "description": "Development",
      "url": "https://owapps-dev.app.cloud.gov/expertquery/attains"
    },
    {
      "description": "Developer",
      "url": " http://localhost:{port}/attains",
      "variables": {
        "port": {
          "default": 9090
        }
      }
    }
  ],
  "info": {
    "description": "Use this web service to calculate a rainfall erosivity factor (R factor) for small construction sites based on the construction start date, end date and location.\n  \n  If the small construction project is located in an area where EPA is the permitting authority and the R factor is less than five, then under EPA's stormwater regulation, NPDES permitting requirements can be waived for the stormwater discharges from the construction site. \n",
    "version": "1.0.0",
    "title": "Expert Query",
    "termsOfService": "https://edg.epa.gov/EPA_Data_License.html",
    "contact": {
      "email": "cgp@epa.gov"
    },
    "license": {
      "name": "Creative Commons Zero Public Domain Dedication",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/"
    }
  },
  "paths": {
    "/data/actions": {
      "summary": "Query Actions profile data",
      "get": {
        "tags": ["Actions"],
        "parameters": [
          { "$ref": "#/components/parameters/objectIdParam" },
          { "$ref": "#/components/parameters/actionAgencyParam" },
          { "$ref": "#/components/parameters/actionIdParam" },
          { "$ref": "#/components/parameters/actionNameParam" },
          { "$ref": "#/components/parameters/actionTypeParam" },
          { "$ref": "#/components/parameters/assessmentUnitIdParam" },
          { "$ref": "#/components/parameters/assessmentUnitNameParam" },
          { "$ref": "#/components/parameters/completionDateLoParam" },
          { "$ref": "#/components/parameters/completionDateHiParam" },
          { "$ref": "#/components/parameters/includeInMeasureParam" },
          { "$ref": "#/components/parameters/inIndianCountryParam" },
          { "$ref": "#/components/parameters/organizationIdParam" },
          { "$ref": "#/components/parameters/organizationNameParam" },
          { "$ref": "#/components/parameters/parameterParam" },
          { "$ref": "#/components/parameters/regionParam" },
          { "$ref": "#/components/parameters/stateParam" },
          { "$ref": "#/components/parameters/waterTypeParam" }
        ],
        "responses": {
          "200": { "$ref": "#/components/responses/ActionsQuerySuccess" },
          "400": { "$ref": "#components/responses/InvalidRequestError" },
          "500": { "$ref": "#components/responses/ServerError" }
        }
      },
      "post": {
        "tags": ["Actions"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ActionsRequestBody" }
            }
          },
          "required": true
        },
        "responses": {
          "200": { "$ref": "#/components/responses/ActionsQuerySuccess" },
          "400": { "$ref": "#components/responses/InvalidRequestError" },
          "500": { "$ref": "#components/responses/ServerError" }
        }
      }
    },
    "/v1/rfactor": {
      "get": {
        "tags": ["Rainfall Erosivity"],
        "summary": "Determine your eligibility for the LEW",
        "description": "Calculates a rainfall erosivity factor (R factor) based on a small construction siteâ€™s start date, end date and location.",
        "operationId": "calculateRFactorGet",
        "parameters": [
          {
            "name": "start_date",
            "in": "query",
            "description": "Date of initial earth disturbance provided in ISO 8601 format",
            "required": true,
            "schema": {
              "type": "string",
              "example": "2019-01-15",
              "default": "2019-01-15"
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "Date of final stabilization provided in ISO 8601 format",
            "required": true,
            "schema": {
              "type": "string",
              "example": "2019-03-13",
              "default": "2019-03-13"
            }
          },
          {
            "name": "location",
            "in": "query",
            "description": "Location to be examined for LEW eligibility provided as a GeoJSON point geometry",
            "required": true,
            "schema": {
              "type": "string",
              "example": "{\"geometry\":{\"type\":\"Point\",\"coordinates\":[-87.845556,42.582222]}}",
              "default": "{\"geometry\":{\"type\":\"Point\",\"coordinates\":[-87.845556,42.582222]}}"
            }
          },
          {
            "in": "header",
            "name": "X-Api-Key",
            "description": "API key used to access EPA web service resources. The below default value key is used for testing purposes only. Web service consumers should <a target=\"_blank\" href=\"..\\api_key_signup.html\">obtain their own API key</a>",
            "schema": {
              "type": "string",
              "default": "yCM9DKRltA4gTGovk2naSvodO5iUDBCT7FAJ3CF5"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RFactorOutput"
                }
              }
            }
          }
        }
      }
    }
  },
  "externalDocs": {
    "description": "Find out more about LEW eligibility and exceptions.",
    "url": "https://www.epa.gov/npdes/rainfall-erosivity-factor-calculator-small-construction-sites"
  },
  "components": {
    "schemas": {
      "ActionsRequestBody": {
        "type": "object",
        "properties": {
          "filters": {
            "type": "object",
            "properties": {
              "actionAgency": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/ActionAgency" }
              },
              "actionId": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/ActionId" }
              },
              "actionName": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/ActionName" }
              },
              "actionType": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/ActionType" }
              },
              "assessmentUnitId": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/AssessmentUnitId" }
              },
              "assessmentUnitName": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/AssessmentUnitName" }
              },
              "completionDate": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Date" }
              },
              "includeInMeasure": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/YesOrNo" }
              },
              "inIndianCountry": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/YesOrNo" }
              },
              "objectId": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/ObjectId" }
              },
              "organizationId": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/OrganizationId" }
              },
              "organizationName": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/OrganizationName" }
              },
              "parameter": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Parameter" }
              },
              "region": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Region" }
              },
              "state": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/State" }
              },
              "waterType": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/WaterType" }
              }
            }
          }
        }
      },
      "RFactorInput": {
        "type": "object",
        "title": "RFactor Input",
        "properties": {
          "start_date": {
            "type": "string",
            "example": "2019-01-15"
          },
          "end_date": {
            "type": "string",
            "example": "2019-03-13"
          },
          "location": {
            "type": "object",
            "title": "GeoJSON Point",
            "properties": {
              "geometry": {
                "type": "object",
                "title": "GeoJSON Point",
                "properties": {
                  "type": {
                    "type": "string",
                    "example": "Point"
                  },
                  "coordinates": {
                    "type": "array",
                    "items": {
                      "type": "number"
                    },
                    "example": [-87.845556, 42.582222]
                  }
                },
                "required": ["type", "coordinates"]
              }
            },
            "required": ["geometry"]
          }
        },
        "required": ["startDate", "endDate", "location"]
      },
      "RFactorOutput": {
        "type": "object",
        "title": "RFactor Output",
        "properties": {
          "rfactor": {
            "type": "number",
            "format": "double",
            "example": 0.476
          }
        },
        "required": ["factor"]
      },
      "ActionAgency": {
        "type": "string",
        "enum": ["EPA", "State", "Tribal"]
      },
      "ActionId": {
        "type": "string",
        "example": "64808"
      },
      "ActionName": {
        "type": "string",
        "example": "12-Mile Creek"
      },
      "ActionType": {
        "type": "string",
        "example": "Implementation Completed"
      },
      "AssessmentUnitId": {
        "type": "string",
        "example": "AZ150200001-010_00"
      },
      "AssessmentUnitName": {
        "type": "string",
        "example": "Abbott Branch"
      },
      "Date": {
        "type": "string",
        "format": "date",
        "example": "04-28-2023"
      },
      "LocationDescription": {
        "type": "string",
        "example": "LAKE WATEREE NEAR END OF TAYLOR CREEK ARM"
      },
      "ObjectId": {
        "type": "number",
        "example": 42
      },
      "OrganizationId": {
        "type": "string",
        "example": "21AS"
      },
      "OrganizationName": {
        "type": "string",
        "example": "Georgia Environmental Protection Division"
      },
      "OrganizationType": {
        "type": "string",
        "enum": ["State", "Tribe"]
      },
      "Parameter": {
        "type": "string",
        "example": "EUTROPHICATION"
      },
      "Region": {
        "type": "string",
        "example": "08"
      },
      "State": {
        "type": "string",
        "example": "TX"
      },
      "WaterSize": {
        "type": "number",
        "format": "float",
        "example": 4.4
      },
      "WaterSizeUnits": {
        "type": "string",
        "example": "Square Miles"
      },
      "WaterType": {
        "type": "string",
        "example": "ESTUARY"
      },
      "YesOrNo": {
        "type": "string",
        "enum": ["Y", "N"]
      }
    },
    "parameters": {
      "actionAgencyParam": {
        "name": "actionAgency",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": {
            "$ref": "#/components/schemas/ActionAgency"
          }
        }
      },
      "actionIdParam": {
        "name": "actionId",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/ActionId" }
        }
      },
      "actionNameParam": {
        "name": "actionName",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/ActionName" }
        }
      },
      "actionTypeParam": {
        "name": "actionType",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#components/schemas/ActionType" }
        }
      },
      "assessmentUnitIdParam": {
        "name": "assessmentUnitId",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#components/schemas/AssessmentUnitId" }
        }
      },
      "assessmentUnitNameParam": {
        "name": "assessmentUnitName",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#components/schemas/AssessmentUnitName" }
        }
      },
      "columnsParam": {
        "name": "columns",
        "description": "The columns to return in the result set, and the order in which to return them.",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "example": ["assessmentUnitId", "assessmentUnitName"]
        }
      },
      "completionDateLoParam": {
        "name": "completionDateLo",
        "in": "query",
        "schema": { "$ref": "#components/schemas/Date" }
      },
      "completionDateHiParam": {
        "name": "completionDateHi",
        "in": "query",
        "schema": { "$ref": "#components/schemas/Date" }
      },
      "formatParam": {
        "name": "format",
        "description": "The format in which data is returned. JSON data is returned inline, other types are returned as a file attachment.",
        "in": "query",
        "schema": {
          "type": "string",
          "default": "json",
          "enum": ["json", "csv", "tsv", "xlsx"]
        }
      },
      "includeInMeasureParam": {
        "name": "includeInMeasure",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/YesOrNo" }
        }
      },
      "inIndianCountryParam": {
        "name": "inIndianCountry",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/YesOrNo" }
        }
      },
      "objectIdParam": {
        "name": "objectId",
        "description": "The unique ID assigned to a data item under the current profile",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": {
            "$ref": "#/components/schemas/ObjectId"
          }
        }
      },
      "organizationIdParam": {
        "name": "organizationId",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/OrganizationId" }
        }
      },
      "organizationNameParam": {
        "name": "organizationName",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/OrganizationName" }
        }
      },
      "parameterParam": {
        "name": "parameter",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/Parameter" }
        }
      },
      "regionParam": {
        "name": "region",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/Region" }
        }
      },
      "stateParam": {
        "name": "state",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/State" }
        }
      },
      "waterTypeParam": {
        "name": "waterType",
        "in": "query",
        "explode": true,
        "schema": {
          "type": "array",
          "items": { "$ref": "#/components/schemas/WaterType" }
        }
      }
    },
    "responses": {
      "ActionsQuerySuccess": {
        "description": "A successful query response",
        "content": {
          "application/octet-stream": {
            "examples": {
              "xlsx": {
                "summary": "A binary encoded XLSX file",
                "externalValue": ""
              }
            },
            "schema": {
              "type": "string",
              "format": "binary"
            }
          },
          "text/csv": {
            "schema": {
              "type": "string",
              "format": "csv"
            }
          },
          "text/tsv": {
            "schema": {
              "type": "string",
              "format": "tsv"
            }
          },
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "nextId": {
                  "type": "integer",
                  "example": 20
                },
                "data": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "actionAgency": {
                        "$ref": "#/components/schemas/ActionAgency"
                      },
                      "actionId": { "$ref": "#/components/schemas/ActionId" },
                      "actionName": {
                        "$ref": "#/components/schemas/ActionName"
                      },
                      "actionType": {
                        "$ref": "#/components/schemas/ActionType"
                      },
                      "assessmentUnitId": {
                        "$ref": "#/components/schemas/AssessmentUnitId"
                      },
                      "assessmentUnitName": {
                        "$ref": "#/components/schemas/AssessmentUnitName"
                      },
                      "completionDate": { "$ref": "#/components/schemas/Date" },
                      "includeInMeasure": {
                        "$ref": "#/components/schemas/YesOrNo"
                      },
                      "inIndianCountry": {
                        "$ref": "#/components/schemas/YesOrNo"
                      },
                      "locationDescription": {
                        "$ref": "#/components/schemas/LocationDescription"
                      },
                      "objectId": {
                        "$ref": "#/components/schemas/ObjectId"
                      },
                      "organizationId": {
                        "$ref": "#/components/schemas/OrganizationId"
                      },
                      "organizationName": {
                        "$ref": "#/components/schemas/OrganizationName"
                      },
                      "organizationType": {
                        "$ref": "#/components/schemas/OrganizationType"
                      },
                      "parameter": {
                        "$ref": "#/components/schemas/Parameter"
                      },
                      "region": {
                        "$ref": "#/components/schemas/Region"
                      },
                      "state": {
                        "$ref": "#/components/schemas/State"
                      },
                      "waterSize": {
                        "$ref": "#/components/schemas/WaterSize"
                      },
                      "waterSizeUnits": {
                        "$ref": "#/components/schemas/WaterSizeUnits"
                      },
                      "waterType": {
                        "$ref": "#/components/schemas/WaterType"
                      }
                    }
                  }
                }
              },
              "required": ["data"]
            }
          }
        }
      },
      "InvalidRequestError": {
        "description": "The request was invalid",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": {
                  "type": "number",
                  "default": 400
                },
                "message": {
                  "type": "string"
                }
              },
              "required": ["code", "message"]
            }
          }
        }
      },
      "ServerError": {
        "description": "An internal server error occurred",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": {
                  "type": "number",
                  "default": 500
                },
                "message": {
                  "type": "string"
                }
              },
              "required": ["code", "message"]
            }
            }
          }
        }
      }
    }
  }
}
